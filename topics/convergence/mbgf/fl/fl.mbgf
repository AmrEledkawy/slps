<?xml version="1.0" encoding="UTF-8"?>
<mbgf:sequence xmlns:bgf="http://planet-sl.org/bgf" xmlns:xbgf="http://planet-sl.org/xbgf" xmlns:mbgf="http://planet-sl.org/mbgf">
	<sources>
		<src name="ant">snapshot/antlr.bgf</src>
		<src name="dcg">snapshot/dcg.bgf</src>
		<src name="sdf">snapshot/sdf.bgf</src>
		<src name="rsc">snapshot/rascal.bgf</src>
	</sources>
	<!-- <naming-convention>
		<default>l_</default>
		<state src="dcg">l_</state>
		<state src="sdf,rsc">C_</state>
	</naming-convention> -->
	<!-- also possible to do individual name bindings -->
	<name-bind>
		<name>program</name>
		<state src="ant,dcg">program</state>
		<state src="sdf,rsc">Program</state>
	</name-bind>
	<name-bind>
		<name>function</name>
		<state src="ant,dcg">function</state>
		<state src="sdf,rsc">Function</state>
	</name-bind>
	<name-bind>
		<name>expr</name>
		<state src="ant,dcg">expr</state>
		<state src="sdf,rsc">Expr</state>
	</name-bind>
	<name-bind>
		<name>name</name>
		<state src="ant">ID</state>
		<state src="dcg">name</state>
		<state src="sdf,rsc">Name</state>
	</name-bind>
	<name-bind>
		<name>newline</name>
		<state src="ant">NEWLINE</state>
		<state src="dcg">newline</state>
		<state src="sdf,rsc">Newline</state>
	</name-bind>
	<name-bind>
		<name>int</name>
		<state src="ant,dcg">int</state>
		<state src="sdf,rsc">Int</state>
	</name-bind>
	<name-bind>
		<name>ops</name>
		<state src="ant,dcg">ops</state>
		<state src="sdf,rsc">Ops</state>
	</name-bind>
	<width>
		<bgf:expression>
			<nonterminal>newline</nonterminal>
		</bgf:expression>
		<state src="ant,dcg,sdf">+</state>
		<state src="rsc">!</state>
		<in>
			<nonterminal>function</nonterminal>
		</in>
	</width>
	<unification id="uni">
		<name>expr</name>
		<state src="ant,dcg">
			<bgf:production>
				<!-- <label>literal</label> -->
				<nonterminal>atom</nonterminal>
				<bgf:expression>
					<nonterminal>int</nonterminal>
				</bgf:expression>
			</bgf:production>
			<bgf:production>
				<!-- <label>argument</label> -->
				<nonterminal>atom</nonterminal>
				<bgf:expression>
					<nonterminal>name</nonterminal>
				</bgf:expression>
			</bgf:production>
			<bgf:production>
				<nonterminal>atom</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>(</terminal>
						</bgf:expression>
						<bgf:expression>
							<nonterminal>expr</nonterminal>
						</bgf:expression>
						<bgf:expression>
							<terminal>)</terminal>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
			<in>
				<label>apply</label>
				<label>binary</label>
			</in>
		</state>
	</unification>
	<iteration id="iter" depends="uni:unite">
		<label>binary</label>
		<name>expr</name>
		<separator>ops</separator>
		<state src="ant,dcg">iterate</state>
		<state src="sdf,rsc">lassoc</state>
	</iteration>
	<!-- at this point sdf, rsc and dcg converged; working with antlr -->
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>program</nonterminal>
				<bgf:expression>
					<plus>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>f</selector>
										<bgf:expression>
											<nonterminal>function</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
					</plus>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>function</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>n</selector>
										<bgf:expression>
											<nonterminal>name</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<marked>
										<bgf:expression>
											<selectable>
												<selector>a</selector>
												<bgf:expression>
													<nonterminal>name</nonterminal>
												</bgf:expression>
											</selectable>
										</bgf:expression>
									</marked>
								</bgf:expression>
							</plus>
						</bgf:expression>
						<bgf:expression>
							<terminal>=</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<nonterminal>newline</nonterminal>
								</bgf:expression>
							</plus>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<!-- <selectables depends="uni:split">
		<state src="ant">
			<bgf:production>
				<nonterminal>binary</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>l</selector>
										<bgf:expression>
											<nonterminal>atom</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<star>
								<bgf:expression>
									<sequence>
										<bgf:expression>
											<marked>
												<bgf:expression>
													<selectable>
														<selector>o</selector>
														<bgf:expression>
															<nonterminal>ops</nonterminal>
														</bgf:expression>
													</selectable>
												</bgf:expression>
											</marked>
										</bgf:expression>
										<bgf:expression>
											<marked>
												<bgf:expression>
													<selectable>
														<selector>r</selector>
														<bgf:expression>
															<nonterminal>atom</nonterminal>
														</bgf:expression>
													</selectable>
												</bgf:expression>
											</marked>
										</bgf:expression>
									</sequence>
								</bgf:expression>
							</star>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables depends="uni:split">
		<state src="ant">
			<bgf:production>
				<nonterminal>apply</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>i</selector>
										<bgf:expression>
											<nonterminal>ID</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<marked>
										<bgf:expression>
											<selectable>
												<selector>a</selector>
												<bgf:expression>
													<nonterminal>atom</nonterminal>
												</bgf:expression>
											</selectable>
										</bgf:expression>
									</marked>
								</bgf:expression>
							</plus>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>ifThenElse</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>if</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>c</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<terminal>then</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e1</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<terminal>else</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e2</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables> -->
	<top-choice id="tc">
		<name>ops</name>
		<state src="ant">horizontal</state>
		<state src="dcg,sdf,rsc">vertical</state>
	</top-choice>
	<selectables depends="tc:horizontal">
		<state src="dcg,sdf,rsc">
			<bgf:production>
				<nonterminal>ops</nonterminal>
				<bgf:expression>
					<choice>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>equal</selector>
										<bgf:expression>
											<terminal>==</terminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>plus</selector>
										<bgf:expression>
											<terminal>+</terminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>minus</selector>
										<bgf:expression>
											<terminal>-</terminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
					</choice>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<choice>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>b</selector>
										<bgf:expression>
											<nonterminal>binary</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>a</selector>
										<bgf:expression>
											<nonterminal>apply</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>i</selector>
										<bgf:expression>
											<nonterminal>ifThenElse</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
					</choice>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<folding>
		<state src="ant">
			<bgf:production>
				<nonterminal>apply</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<selectable>
								<selector>i</selector>
								<bgf:expression>
									<nonterminal>name</nonterminal>
								</bgf:expression>
							</selectable>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<selectable>
										<selector>a</selector>
										<bgf:expression>
											<nonterminal>atom</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</plus>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</folding>
	<folding>
		<state src="ant">
			<bgf:production>
				<nonterminal>ifThenElse</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>if</terminal>
						</bgf:expression>
						<bgf:expression>
							<selectable>
								<selector>c</selector>
								<bgf:expression>
									<nonterminal>expr</nonterminal>
								</bgf:expression>
							</selectable>
						</bgf:expression>
						<bgf:expression>
							<terminal>then</terminal>
						</bgf:expression>
						<bgf:expression>
							<selectable>
								<selector>e1</selector>
								<bgf:expression>
									<nonterminal>expr</nonterminal>
								</bgf:expression>
							</selectable>
						</bgf:expression>
						<bgf:expression>
							<terminal>else</terminal>
						</bgf:expression>
						<bgf:expression>
							<selectable>
								<selector>e2</selector>
								<bgf:expression>
									<nonterminal>expr</nonterminal>
								</bgf:expression>
							</selectable>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</folding>
	<folding id="fld">
		<state src="ant">
			<bgf:production>
				<nonterminal>binary</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<selectable>
								<selector>l</selector>
								<bgf:expression>
									<nonterminal>atom</nonterminal>
								</bgf:expression>
							</selectable>
						</bgf:expression>
						<bgf:expression>
							<star>
								<bgf:expression>
									<sequence>
										<bgf:expression>
											<selectable>
												<selector>o</selector>
												<bgf:expression>
													<nonterminal>ops</nonterminal>
												</bgf:expression>
											</selectable>
										</bgf:expression>
										<bgf:expression>
											<selectable>
												<selector>r</selector>
												<bgf:expression>
													<nonterminal>atom</nonterminal>
												</bgf:expression>
											</selectable>
										</bgf:expression>
									</sequence>
								</bgf:expression>
							</star>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</folding>
	<top-choice depends="fld:inline">
		<name>expr</name>
		<state src="ant">vertical</state>
		<!-- <state src="dcg,sdf,rsc">vertical</state> -->
	</top-choice>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>l</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<star>
								<bgf:expression>
									<sequence>
										<bgf:expression>
											<marked>
												<bgf:expression>
													<selectable>
														<selector>o</selector>
														<bgf:expression>
															<nonterminal>ops</nonterminal>
														</bgf:expression>
													</selectable>
												</bgf:expression>
											</marked>
										</bgf:expression>
										<bgf:expression>
											<marked>
												<bgf:expression>
													<selectable>
														<selector>r</selector>
														<bgf:expression>
															<nonterminal>expr</nonterminal>
														</bgf:expression>
													</selectable>
												</bgf:expression>
											</marked>
										</bgf:expression>
									</sequence>
								</bgf:expression>
							</star>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>i</selector>
										<bgf:expression>
											<nonterminal>name</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<marked>
										<bgf:expression>
											<selectable>
												<selector>a</selector>
												<bgf:expression>
													<nonterminal>expr</nonterminal>
												</bgf:expression>
											</selectable>
										</bgf:expression>
									</marked>
								</bgf:expression>
							</plus>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>if</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>c</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<terminal>then</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e1</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<terminal>else</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e2</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<selectables>
		<state src="ant">
			<bgf:production>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>(</terminal>
						</bgf:expression>
						<bgf:expression>
							<marked>
								<bgf:expression>
									<selectable>
										<selector>e</selector>
										<bgf:expression>
											<nonterminal>expr</nonterminal>
										</bgf:expression>
									</selectable>
								</bgf:expression>
							</marked>
						</bgf:expression>
						<bgf:expression>
							<terminal>)</terminal>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</selectables>
	<production-label>
		<state src="dcg">
			<bgf:production>
				<label>ifThenElse</label>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<terminal>if</terminal>
						</bgf:expression>
						<bgf:expression>
							<nonterminal>expr</nonterminal>
						</bgf:expression>
						<bgf:expression>
							<terminal>then</terminal>
						</bgf:expression>
						<bgf:expression>
							<nonterminal>expr</nonterminal>
						</bgf:expression>
						<bgf:expression>
							<terminal>else</terminal>
						</bgf:expression>
						<bgf:expression>
							<nonterminal>expr</nonterminal>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</production-label>
	<production-label>
		<state src="dcg">
			<bgf:production>
				<label>apply</label>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<nonterminal>name</nonterminal>
						</bgf:expression>
						<bgf:expression>
							<plus>
								<bgf:expression>
									<nonterminal>atom</nonterminal>
								</bgf:expression>
							</plus>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</production-label>
	<production-label>
		<state src="dcg">
			<bgf:production>
				<label>binary</label>
				<nonterminal>expr</nonterminal>
				<bgf:expression>
					<sequence>
						<bgf:expression>
							<nonterminal>atom</nonterminal>
						</bgf:expression>
						<bgf:expression>
							<star>
								<bgf:expression>
									<sequence>
										<bgf:expression>
											<nonterminal>ops</nonterminal>
										</bgf:expression>
										<bgf:expression>
											<nonterminal>atom</nonterminal>
										</bgf:expression>
									</sequence>
								</bgf:expression>
							</star>
						</bgf:expression>
					</sequence>
				</bgf:expression>
			</bgf:production>
		</state>
	</production-label>
</mbgf:sequence>
