<xbgf:sequence
  xmlns:bgf="http://planet-sl.org/bgf"
  xmlns:xbgf="http://planet-sl.org/xbgf">

  <!--
  NOT semantic-preserving in any way.
  
   - Fail: MethodBody.
      - [], n(Block)
     vs.
      - [], ;([n(Block), t((;))])
  -->
  <xbgf:vertical>
    <nonterminal>MethodBody</nonterminal>
  </xbgf:vertical>
  <xbgf:remove>
    <bgf:production>
      <nonterminal>MethodBody</nonterminal>
      <bgf:expression>
        <terminal>;</terminal>
      </bgf:expression>
    </bgf:production>
  </xbgf:remove>

  <!--
   - Fail: SwitchBlockStatementGroup.
      - [], ,([n(SwitchLabel), n(BlockStatements)])
     vs.
      - [], ,([n(SwitchLabels), n(BlockStatements)])
-->
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>SwitchLabels</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <nonterminal>SwitchLabel</nonterminal>
    </bgf:expression>
    <in>
      <nonterminal>SwitchBlockStatementGroup</nonterminal>
    </in>
  </xbgf:replace>

  <!--
  ConstructorBody is defined as:
     { [ ExplicitConstructorInvocation ] [ BlockStatements ] }
  -->
  <xbgf:undefine>ConstructorBody</xbgf:undefine>
  <xbgf:unite>
    <add>ConstructorBody</add>
    <to>MethodBody</to>
  </xbgf:unite>
  <xbgf:eliminate>ExplicitConstructorInvocation</xbgf:eliminate>
  <xbgf:eliminate>ArgumentList</xbgf:eliminate>

  <!--
   Some productions use a more general QualifiedIdentifierList instead of TypeList
  -->
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>TypeList</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <nonterminal>QualifiedIdentifierList</nonterminal>
    </bgf:expression>
    <in>
      <nonterminal>ConstructorDeclaratorRest</nonterminal>
    </in>
  </xbgf:replace>
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>TypeList</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <nonterminal>QualifiedIdentifierList</nonterminal>
    </bgf:expression>
    <in>
      <nonterminal>MethodDeclaratorRest</nonterminal>
    </in>
  </xbgf:replace>
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>TypeList</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <nonterminal>QualifiedIdentifierList</nonterminal>
    </bgf:expression>
    <in>
      <nonterminal>VoidInterfaceMethodDeclaratorRest</nonterminal>
    </in>
  </xbgf:replace>
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>TypeList</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <nonterminal>QualifiedIdentifierList</nonterminal>
    </bgf:expression>
    <in>
      <nonterminal>InterfaceMethodDeclaratorRest</nonterminal>
    </in>
  </xbgf:replace>
  <xbgf:define>
    <bgf:production>
      <nonterminal>QualifiedIdentifierList</nonterminal>
      <bgf:expression>
        <sequence>
          <bgf:expression>
            <nonterminal>QualifiedIdentifier</nonterminal>
          </bgf:expression>
          <bgf:expression>
            <star>
              <bgf:expression>
                <sequence>
                  <bgf:expression>
                    <terminal>,</terminal>
                  </bgf:expression>
                  <bgf:expression>
                    <nonterminal>QualifiedIdentifier</nonterminal>
                  </bgf:expression>
                </sequence>
              </bgf:expression>
            </star>
          </bgf:expression>
        </sequence>
      </bgf:expression>
    </bgf:production>
  </xbgf:define>

  <!--
   - Fail: MethodDeclaratorRest.
      - [], ,([n(FormalParameters), n(BracketsOpt), ?(,([t(throws), n(QualifiedIdentifierList)])), ;([n(MethodBody), t((;))])])
     vs.
      - [], ,([n(FormalParameters), ?(,([t(throws), n(QualifiedIdentifierList)])), n(MethodBody)])
  -->
  <xbgf:inject>
    <bgf:production>
      <nonterminal>MethodDeclaratorRest</nonterminal>
      <bgf:expression>
        <sequence>
          <bgf:expression>
            <nonterminal>FormalParameters</nonterminal>
          </bgf:expression>
          <bgf:expression>
            <nonterminal>BracketsOpt</nonterminal>
          </bgf:expression>
          <bgf:expression>
            <optional>
              <bgf:expression>
                <sequence>
                  <bgf:expression>
                    <terminal>throws</terminal>
                  </bgf:expression>
                  <bgf:expression>
                    <nonterminal>QualifiedIdentifierList</nonterminal>
                  </bgf:expression>
                </sequence>
              </bgf:expression>
            </optional>
          </bgf:expression>
          <bgf:expression>
            <nonterminal>MethodBody</nonterminal>
          </bgf:expression>
        </sequence>
      </bgf:expression>
    </bgf:production>
  </xbgf:inject>
  <xbgf:replace>
    <bgf:expression>
      <nonterminal>MethodBody</nonterminal>
    </bgf:expression>
    <bgf:expression>
      <choice>
        <bgf:expression>
          <nonterminal>MethodBody</nonterminal>
        </bgf:expression>
        <bgf:expression>
          <terminal>;</terminal>
        </bgf:expression>
      </choice>
    </bgf:expression>
    <in>
      <nonterminal>MethodDeclaratorRest</nonterminal>
    </in>
  </xbgf:replace>
  
  <!--
   - Fail: InterfaceMethodDeclaratorRest.
      - [], ,([n(FormalParameters), n(BracketsOpt), ?(,([t(throws), n(QualifiedIdentifierList)])), t((;))])
     vs.
      - [], ,([n(FormalParameters), ?(,([t(throws), n(QualifiedIdentifierList)])), t((;))])
  -->
  <xbgf:inject>
    <bgf:production>
      <nonterminal>InterfaceMethodDeclaratorRest</nonterminal>
      <bgf:expression>
        <sequence>
          <bgf:expression>
            <nonterminal>FormalParameters</nonterminal>
          </bgf:expression>
          <bgf:expression>
            <nonterminal>BracketsOpt</nonterminal>
          </bgf:expression>
          <bgf:expression>
            <optional>
              <bgf:expression>
                <sequence>
                  <bgf:expression>
                    <terminal>throws</terminal>
                  </bgf:expression>
                  <bgf:expression>
                    <nonterminal>QualifiedIdentifierList</nonterminal>
                  </bgf:expression>
                </sequence>
              </bgf:expression>
            </optional>
          </bgf:expression>
          <bgf:expression>
            <terminal>;</terminal>
          </bgf:expression>
        </sequence>
      </bgf:expression>
    </bgf:production>
  </xbgf:inject>

  <!--
   - Fail: ArrayInitializer.
      - [], ,([t({), ?(,([n(VariableInitializer), *(,([t((,)), n(VariableInitializer)])), ?(t((,)))])), t(})])
     vs.
      - [], ,([t({), ?(,([n(VariableInitializer), *(,([t((,)), n(VariableInitializer)]))])), ?(t((,))), t(})])
      
   ArrayInitializer is defined as:                          (collected)
     "{" [ VariableInitializers ] [ "," ] "}"
   ArrayInitializer is defined as:                          (syntax)
     "{" [ VariableInitializers [ "," ] ] "}"
  -->
  <xbgf:replace>
    <bgf:expression>
      <sequence>
        <bgf:expression>
          <optional>
            <bgf:expression>
              <sequence>
                <bgf:expression>
                  <nonterminal>VariableInitializer</nonterminal>
                </bgf:expression>
                <bgf:expression>
                  <star>
                    <bgf:expression>
                      <sequence>
                        <bgf:expression>
                          <terminal>,</terminal>
                        </bgf:expression>
                        <bgf:expression>
                          <nonterminal>VariableInitializer</nonterminal>
                        </bgf:expression>
                      </sequence>
                    </bgf:expression>
                  </star>
                </bgf:expression>
              </sequence>
            </bgf:expression>
          </optional>
        </bgf:expression>
        <bgf:expression>
          <optional>
            <bgf:expression>
              <terminal>,</terminal>
            </bgf:expression>
          </optional>
        </bgf:expression>
      </sequence>
    </bgf:expression>
    <bgf:expression>
      <optional>
        <bgf:expression>
          <sequence>
            <bgf:expression>
              <nonterminal>VariableInitializer</nonterminal>
            </bgf:expression>
            <bgf:expression>
              <star>
                <bgf:expression>
                  <sequence>
                    <bgf:expression>
                      <terminal>,</terminal>
                    </bgf:expression>
                    <bgf:expression>
                      <nonterminal>VariableInitializer</nonterminal>
                    </bgf:expression>
                  </sequence>
                </bgf:expression>
              </star>
            </bgf:expression>
            <bgf:expression>
              <optional>
                <bgf:expression>
                  <terminal>,</terminal>
                </bgf:expression>
              </optional>
            </bgf:expression>
          </sequence>
        </bgf:expression>
      </optional>
    </bgf:expression>
    <in>
      <nonterminal>ArrayInitializer</nonterminal>
    </in>
  </xbgf:replace>
</xbgf:sequence>